name: GitHub Pages

# å½“æ¨é€åˆ°ä»¥ä¸‹åˆ†æ”¯æ—¶è§¦å‘éƒ¨ç½²
on:
  push:
    branches:
      # é¡¹ç›®æºä»£ç æ‰€åœ¨çš„åˆ†æ”¯ï¼Œè¿™é‡Œå¯ä»¥æ˜¯ä¸»åˆ†æ”¯ï¼ˆmainï¼‰ã€æ—§ç‰ˆåˆ†æ”¯ï¼ˆmasterï¼‰æˆ–è€…ä½ é€‰æ‹©çš„å…¶ä»–åˆ†æ”¯ï¼ˆå¦‚ valaxyï¼‰
      - main
      - master
      - valaxy

jobs:
  build:
    # è®¾ç½®æ“ä½œç³»ç»Ÿ
    runs-on: ${{ matrix.os }}

    # è®¾ç½® Node.js ç‰ˆæœ¬å’Œæ“ä½œç³»ç»Ÿçš„çŸ©é˜µç­–ç•¥
    strategy:
      matrix:
        node-version: [lts/*]  # ä½¿ç”¨æœ€æ–°çš„ LTS ç‰ˆæœ¬çš„ Node.js
        os: [ubuntu-latest]    # ä½¿ç”¨æœ€æ–°ç‰ˆæœ¬çš„ Ubuntu æ“ä½œç³»ç»Ÿ
      fail-fast: false

    steps:
      # æ£€å‡ºä»£ç ä»“åº“
      - uses: actions/checkout@v2

      # è®¾ç½® Node.js ç¯å¢ƒ
      - name: Use Node.js ${{ matrix.node-version }}
        uses: actions/setup-node@v2
        with:
          node-version: ${{ matrix.node-version }}
          registry-url: https://registry.npmjs.org/  # æŒ‡å®š npm çš„æ³¨å†Œæº

      # å®‰è£…ä¾èµ–
      - name: ğŸ“¦ Install Dependencies
        run: npm install  # ä½¿ç”¨ npm å®‰è£…é¡¹ç›®ä¾èµ–ï¼ˆä½ å¯ä»¥æ”¹ç”¨ pnpm å–å†³äºä½ çš„é¡¹ç›®ç®¡ç†å·¥å…·ï¼‰

      # æ„å»º Valaxy åšå®¢
      - name: ğŸŒŒ Build Valaxy Blog
        run: npm run build  # ä½¿ç”¨æ„å»ºå‘½ä»¤ç”Ÿæˆé™æ€æ–‡ä»¶ï¼ˆä½ å¯èƒ½éœ€è¦åœ¨ package.json ä¸­ç¡®è®¤ build è„šæœ¬æ˜¯å¦æ­£ç¡®ï¼‰

      # éƒ¨ç½²åˆ° GitHub Pages
      - name: ğŸª¤ Deploy to GitHub Pages
        uses: peaceiris/actions-gh-pages@v3
        with:
          github_token: ${{ secrets.GITHUB_TOKEN }}  # ä½¿ç”¨ GitHub è‡ªåŠ¨ç”Ÿæˆçš„ token è¿›è¡Œè®¤è¯
          publish_dir: ./dist  # æŒ‡å®šéƒ¨ç½²ç›®å½•ï¼ŒValaxy é»˜è®¤ä¼šæŠŠé™æ€æ–‡ä»¶æ”¾åœ¨ ./dist ç›®å½•
          force_orphan: true  # å¼ºåˆ¶åˆ›å»ºä¸€ä¸ªå­¤ç«‹åˆ†æ”¯ï¼Œä¸ç»§æ‰¿å†å²æäº¤è®°å½•ï¼Œé˜²æ­¢å¯èƒ½çš„å†²çª